<cfcomponent displayname="ActivityPerson" output="false">		<cfproperty name="ActivityPersonID" type="numeric" default="" />		<cfproperty name="ActivityID" type="numeric" default="" />		<cfproperty name="LastName" type="string" default="" />		<cfproperty name="FirstName" type="string" default="" />		<cfproperty name="Email" type="string" default="" />		<cfproperty name="Phone" type="string" default="" />		<cfproperty name="Office" type="string" default="" />			<!---	PROPERTIES	--->	<cfset variables.instance = StructNew() />	<!---	INITIALIZATION / CONFIGURATION	--->	<cffunction name="init" access="public" returntype="ActivityPerson" output="false">		<cfargument name="ActivityPersonID" type="string" required="false" default="" />		<cfargument name="ActivityID" type="string" required="false" default="" />		<cfargument name="LastName" type="string" required="false" default="" />		<cfargument name="FirstName" type="string" required="false" default="" />		<cfargument name="Email" type="string" required="false" default="" />		<cfargument name="Phone" type="string" required="false" default="" />			<cfargument name="Office" type="string" required="false" default="" />				<!--- run setters --->		<cfset setActivityPersonID(arguments.ActivityPersonID) />		<cfset setActivityID(arguments.ActivityID) />		<cfset setLastName(arguments.LastName) />		<cfset setFirstName(arguments.FirstName) />		<cfset setEmail(arguments.Email) />		<cfset setPhone(arguments.Phone) />			<cfset setOffice(arguments.Office) />				<cfreturn this /> 	</cffunction>	<!---	PUBLIC FUNCTIONS	--->	<cffunction name="setMemento" access="public" returntype="ActivityPerson" output="false">		<cfargument name="memento" type="struct" required="yes"/>		<cfset variables.instance = arguments.memento />		<cfreturn this />	</cffunction>	<cffunction name="getMemento" access="public" returntype="struct" output="false" >		<cfreturn variables.instance />	</cffunction>	<cffunction name="validateSubmit" access="public" returntype="array" output="false">		<cfset var errors = arrayNew(1) />		<cfset var thisError = structNew() />				<!--- ActivityPersonID --->		<!--- <cfif (len(trim(getActivityPersonID())) AND NOT isNumeric(trim(getActivityPersonID())))>			<cfset thisError.field = "ActivityPersonID" />			<cfset thisError.type = "invalidType" />			<cfset thisError.message = "ActivityPersonID is not numeric" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif> --->				<!--- ActivityID --->		<!--- <cfif (NOT len(trim(getActivityID())))>			<cfset thisError.field = "ActivityID" />			<cfset thisError.type = "required" />			<cfset thisError.message = "ActivityID is required" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>		<cfif (len(trim(getActivityID())) AND NOT isNumeric(trim(getActivityID())))>			<cfset thisError.field = "ActivityID" />			<cfset thisError.type = "invalidType" />			<cfset thisError.message = "ActivityID is not numeric" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif> --->				<!--- LastName --->		<cfif NOT len(trim(getLastName()))>							<cfset thisError.field = "LastName" />			<cfset thisError.type = "required" />			<cfset thisError.message = "Form Section ##01: Last name is required" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>						<cfif (len(trim(getLastName())) AND NOT IsSimpleValue(trim(getLastName())))>			<cfset thisError.field = "LastName" />			<cfset thisError.type = "invalidType" />			<cfset thisError.message = "Form Section ##01: Last name is not a string" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>		<cfif (len(trim(getLastName())) GT 255)>			<cfset thisError.field = "LastName" />			<cfset thisError.type = "tooLong" />			<cfset thisError.message = "Form Section ##01: Last name is too long" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>				<!--- FirstName --->		<cfif NOT len(trim(getFirstName()))>							<cfset thisError.field = "FirstName" />			<cfset thisError.type = "required" />			<cfset thisError.message = "Form Section ##01: First name is required" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>						<cfif (len(trim(getFirstName())) AND NOT IsSimpleValue(trim(getFirstName())))>			<cfset thisError.field = "FirstName" />			<cfset thisError.type = "invalidType" />			<cfset thisError.message = "Form Section ##01: First name is not a string" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>		<cfif (len(trim(getFirstName())) GT 255)>			<cfset thisError.field = "FirstName" />			<cfset thisError.type = "tooLong" />			<cfset thisError.message = "Form Section ##01: First name is too long" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>				<!--- Email --->		<cfif NOT len(trim(getEmail()))>							<cfset thisError.field = "Email" />			<cfset thisError.type = "required" />			<cfset thisError.message = "Form Section ##01: Email is required" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>					<cfif (len(trim(getEmail())) AND NOT IsSimpleValue(trim(getEmail())))>			<cfset thisError.field = "Email" />			<cfset thisError.type = "invalidType" />			<cfset thisError.message = "Form Section ##01: Email is not a string" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>		<cfif (len(trim(getEmail())) GT 255)>			<cfset thisError.field = "Email" />			<cfset thisError.type = "tooLong" />			<cfset thisError.message = "Form Section ##01: Email is too long" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>				<cfif len(trim(getEmail()))>			<cfif NOT REFindNocase("^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*\.(([a-z]{2,3})|(aero|coop|info|museum|name))$", getEmail())>				<cfset thisError.field = "Email" />				<cfset thisError.type = "invalidEmail" />				<cfset thisError.message = "Form Section ##01: Email is invalid" />				<cfset arrayAppend(errors,duplicate(thisError)) />						</cfif>		</cfif>				<!--- Phone --->		<cfif NOT len(trim(getPhone()))>							<cfset thisError.field = "Phone" />			<cfset thisError.type = "required" />			<cfset thisError.message = "Form Section ##01: Phone is required" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>						<cfif (len(trim(getPhone())) AND NOT IsSimpleValue(trim(getPhone())))>			<cfset thisError.field = "Phone" />			<cfset thisError.type = "invalidType" />			<cfset thisError.message = "Form Section ##01: Phone number is not a string" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>		<cfif (len(trim(getPhone())) GT 255)>			<cfset thisError.field = "Phone" />			<cfset thisError.type = "tooLong" />			<cfset thisError.message = "Form Section ##01: Phone number is too long" />			<cfset arrayAppend(errors,duplicate(thisError)) />		</cfif>				<cfreturn errors />	</cffunction>	<!---	ACCESSORS	--->	<cffunction name="setActivityPersonID" access="public" returntype="void" output="false">		<cfargument name="ActivityPersonID" type="string" required="true" />		<cfset variables.instance.ActivityPersonID = arguments.ActivityPersonID />	</cffunction>	<cffunction name="getActivityPersonID" access="public" returntype="string" output="false">		<cfreturn variables.instance.ActivityPersonID />	</cffunction>	<cffunction name="setActivityID" access="public" returntype="void" output="false">		<cfargument name="ActivityID" type="string" required="true" />		<cfset variables.instance.ActivityID = arguments.ActivityID />	</cffunction>	<cffunction name="getActivityID" access="public" returntype="string" output="false">		<cfreturn variables.instance.ActivityID />	</cffunction>	<cffunction name="setLastName" access="public" returntype="void" output="false">		<cfargument name="LastName" type="string" required="true" />		<cfset variables.instance.LastName = arguments.LastName />	</cffunction>	<cffunction name="getLastName" access="public" returntype="string" output="false">		<cfreturn variables.instance.LastName />	</cffunction>	<cffunction name="setFirstName" access="public" returntype="void" output="false">		<cfargument name="FirstName" type="string" required="true" />		<cfset variables.instance.FirstName = arguments.FirstName />	</cffunction>	<cffunction name="getFirstName" access="public" returntype="string" output="false">		<cfreturn variables.instance.FirstName />	</cffunction>	<cffunction name="setEmail" access="public" returntype="void" output="false">		<cfargument name="Email" type="string" required="true" />		<cfset variables.instance.Email = arguments.Email />	</cffunction>	<cffunction name="getEmail" access="public" returntype="string" output="false">		<cfreturn variables.instance.Email />	</cffunction>	<cffunction name="setPhone" access="public" returntype="void" output="false">		<cfargument name="Phone" type="string" required="true" />		<cfset variables.instance.Phone = arguments.Phone />	</cffunction>	<cffunction name="getPhone" access="public" returntype="string" output="false">		<cfreturn variables.instance.Phone />	</cffunction>			<cffunction name="setOffice" access="public" returntype="void" output="false">		<cfargument name="Office" type="string" required="true" />		<cfset variables.instance.Office = arguments.Office />	</cffunction>	<cffunction name="getOffice" access="public" returntype="string" output="false">		<cfreturn variables.instance.Office />	</cffunction>	<!---	DUMP	--->	<cffunction name="dump" access="public" output="true" return="void">		<cfargument name="abort" type="boolean" default="false" />		<cfdump var="#variables.instance#" />		<cfif arguments.abort>			<cfabort />		</cfif>	</cffunction></cfcomponent>
